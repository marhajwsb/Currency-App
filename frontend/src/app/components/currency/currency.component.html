<div class="container mt-5">
  <div class="card shadow-sm">
    <div class="card-header bg-primary text-white">
      <h3 class="mb-0">NBP Currency Explorer</h3>
    </div>
    
    <div class="card-body">
      <section class="row g-3 align-items-end mb-4">
        <div class="col-md-4">
          <label for="date-picker" class="form-label fw-bold">Wybierz datę kursu:</label>
          <input type="date" id="date-picker" class="form-control" 
                 [(ngModel)]="selectedDate" (change)="onDateChange()">
        </div>
        <div class="col-md-4">
          <button (click)="onFetchFromNBP()" [disabled]="loading" class="btn btn-primary w-100">
            <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
            {{ loading ? 'Pobieranie danych...' : 'Zaktualizuj bazę z NBP' }}
          </button>
        </div>
      </section>

      <div *ngIf="errorMessage" class="alert alert-danger d-flex align-items-center" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        {{ errorMessage }}
      </div>

      <section class="results mt-4">
        <div class="table-responsive" *ngIf="rates.length > 0 && !isSearching">
          <table class="table table-striped table-hover align-middle border">
            <thead class="table-light">
              <tr>
                <th>Kod</th>
                <th>Kurs (PLN)</th>
                <th>Rok</th>
                <th class="text-center">Kwartał</th>
                <th class="text-center">Miesiąc</th>
                <th>Pełna Data</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let r of rates">
                <td><span class="badge bg-secondary px-3 py-2">{{ r.code }}</span></td>
                <td class="fw-bold text-primary">{{ r.rate | number:'1.2-4' }}</td>
                <td>{{ getYear(r.date) }}</td>
                <td class="text-center"><span class="badge rounded-pill bg-info text-dark">Q{{ getQuarter(r.date) }}</span></td>
                <td class="text-center">{{ getMonth(r.date) }}</td>
                <td class="text-muted small">{{ r.date }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="text-center py-5" *ngIf="loading || isSearching">
          <div class="spinner-grow text-primary" role="status"></div>
          <p class="mt-2 text-muted">Przetwarzanie danych, proszę czekać...</p>
        </div>

        <div *ngIf="rates.length === 0 && !loading && !isSearching" class="alert alert-light border text-center py-4">
          <i class="bi bi-info-circle fs-2 text-muted d-block mb-2"></i>
          <p class="mb-1">Brak danych w lokalnej bazie dla wybranej daty.</p>
          <small class="text-muted">Kliknij przycisk powyżej, aby zasilić bazę kursami z NBP.</small>
        </div>
      </section>
    </div>
  </div>
</div>